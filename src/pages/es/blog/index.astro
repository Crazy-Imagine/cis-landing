---
import FeaturedArticles from '@/sections/FeaturedArticles.astro';
import Hero from '@/sections/Hero.astro';
import LatestArticles from '@/sections/LatestArticles.astro';
import Layout from '@/layouts/Layout.astro';
import fetchApi from '@/lib/strapi';
import type { SEO } from '@/types/strapi/SEO';
import { getLangFromUrl, useTranslations } from '@/i18n/utils';

const seo = await fetchApi<SEO>({
  endpoint: 'blog',
  params: {
    locale: Astro.currentLocale,
    populate: {
      seo: true,
    },
  },
});

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
---

<Layout
  title={seo.data.attributes.seo.metaTitle}
  description={seo.data.attributes.seo.metaDescription}
>
  <Hero page="blog" />

  <FeaturedArticles />

  <LatestArticles start={2} title={t('common-browse-all-articles')} />
</Layout>
